<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>WV Runs | Run WV | WV Cross Country & Running</title>
  <meta name="description" content="WV Runs - The home for all things West Virginia Cross Country and Track. Results, rankings, schools, and meet info. Find anything about run wv, wvruns, running in wv, wv cross country, wv xc." />
  <meta name="keywords" content="run wv, wvruns, running in wv, wv cross country, wv xc, west virginia cross country, west virginia running, wv running, high school cross country, track and field" />
  <meta property="og:title" content="WV Runs - West Virginia Running & Cross Country" />
  <meta property="og:description" content="Everything cross country and running in WV: results, rankings, schools, meets, and more." />
  <meta property="og:image" content="assets/Wvruns Logo.png" />
  <link rel="icon" type="image/png" href="assets/Favicon Generator/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/svg+xml" href="assets/Favicon Generator/favicon.svg" />
  <link rel="shortcut icon" href="assets/Favicon Generator/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="assets/Favicon Generator/apple-touch-icon.png" />
  <link rel="manifest" href="assets/Favicon Generator/site.webmanifest" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <img src="assets/Wvruns Logo.png" alt="WV Runs Logo" class="logo" />
    <nav>
      <a href="index.html">Home</a>
      <a href="schools.html">Schools</a>
      <a href="meets.html">Meets</a>
      <a href="rankings.html">Rankings</a>
    </nav>
  </header>

  <main>
    <section class="intro">
      <h1>West Virginia Cross Country & Running (Run WV / WV XC)</h1>
      <p>The home for West Virginia cross country and track results — school by school, meet by meet.</p>
    </section>

    <section id="featured-meets">
      <h2>Recent Meets</h2>
      <div id="meet-list">Loading recent meets...</div>
    </section>
  </main>

  <footer>
    <p>&copy; 2025 WV Runs — Built by runners, for runners.</p>
  </footer>

  <!-- Supabase Client Library -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <!-- Supabase Configuration -->
  <script src="supabase-config.js"></script>
  <script>
    async function loadRecentMeets() {
      const container = document.getElementById('meet-list');
      try {
        const { data, error } = await supabase
          .from('meets')
          .select('*')
          .order('date', { ascending: false })
          .limit(6);
        if (error) throw error;
        const meets = data || [];
        if (!meets.length) {
          container.innerHTML = '<p>No recent meets found.</p>';
          return;
        }
        function formatDate(dateString) {
          if (!dateString) return 'Date TBD';
          // Parse date string in local time to avoid timezone shift
          const parts = dateString.split('-');
          if (parts.length === 3) {
            const year = parseInt(parts[0], 10);
            const month = parseInt(parts[1], 10) - 1; // Month is 0-indexed
            const day = parseInt(parts[2], 10);
            const date = new Date(year, month, day);
            return date.toLocaleDateString();
          }
          // Fallback to original method if format is unexpected
          return new Date(dateString).toLocaleDateString();
        }
        container.innerHTML = meets.map(meet => {
          const date = formatDate(meet.date);
          const location = meet.location || '';
          return `
            <a href="meet.html?slug=${meet.slug}" class="meet-card">
              <h3>${meet.name}</h3>
              <p><strong>Date:</strong> ${date}</p>
              ${location ? `<p><strong>Location:</strong> ${location}</p>` : ''}
            </a>
          `;
        }).join('');
      } catch (e) {
        console.error('Error loading meets:', e);
        container.innerHTML = '<p>Error loading recent meets.</p>';
      }
    }
    document.addEventListener('DOMContentLoaded', loadRecentMeets);
  </script>
</body>
</html>
